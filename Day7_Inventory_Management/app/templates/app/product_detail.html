{% extends 'app/base.html' %}

{% block title %}{{ product.name }} - Product Details{% endblock %}

{% block content %}
<h1>Product Details</h1>

<table>
    <tr>
        <th>SKU:</th>
        <td>{{ product.sku }}</td>
    </tr>
    <tr>
        <th>Name:</th>
        <td>{{ product.name }}</td>
    </tr>
    <tr>
        <th>Category:</th>
        <td>{{ product.category.name }}</td>
    </tr>
    <tr>
        <th>Supplier:</th>
        <td>{{ product.supplier.name|default:"-" }}</td>
    </tr>
    <tr>
        <th>Description:</th>
        <td>{{ product.description|default:"No description" }}</td>
    </tr>
    <tr>
        <th>Unit Price:</th>
        <td style="font-weight: bold;">₹{{ product.unit_price }}</td>
    </tr>
    <tr>
        <th>Quantity in Stock:</th>
        <td style="font-weight: bold;">{{ product.quantity_in_stock }}</td>
    </tr>
    <tr>
        <th>Reorder Level:</th>
        <td>{{ product.reorder_level }}</td>
    </tr>
    <tr>
        <th>Total Value:</th>
        <td style="font-weight: bold; color: green;">₹{{ product.total_value|floatformat:2 }}</td>
    </tr>
    <tr>
        <th>Status:</th>
        <td>
            {% if product.is_low_stock %}
            <span class="badge badge-danger">Low Stock - Reorder Required</span>
            {% else %}
            <span class="badge badge-success">In Stock</span>
            {% endif %}
        </td>
    </tr>
    <tr>
        <th>Created:</th>
        <td>{{ product.created_at|date:"d F, Y H:i" }}</td>
    </tr>
    <tr>
        <th>Last Updated:</th>
        <td>{{ product.updated_at|date:"d F, Y H:i" }}</td>
    </tr>
</table>

<h2 style="margin-top: 30px;">Recent Stock Movements</h2>
<table>
    <thead>
        <tr>
            <th>Date</th>
            <th>Type</th>
            <th>Quantity</th>
            <th>Reference</th>
            <th>Notes</th>
        </tr>
    </thead>
    <tbody>
        {% for movement in movements %}
        <tr>
            <td>{{ movement.date|date:"d M, Y H:i" }}</td>
            <td>
                <span class="badge {% if movement.movement_type == 'in' %}badge-success{% elif movement.movement_type == 'out' %}badge-danger{% else %}badge-info{% endif %}">
                    {{ movement.get_movement_type_display }}
                </span>
            </td>
            <td>{{ movement.quantity }}</td>
            <td>{{ movement.reference_number|default:"-" }}</td>
            <td>{{ movement.notes|truncatewords:10 }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="5" style="text-align: center;">No movements recorded</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<div style="margin-top: 20px;">
    <a href="{% url 'product_update' product.pk %}" class="btn btn-warning">Edit Product</a>
    <a href="{% url 'product_delete' product.pk %}" class="btn btn-danger">Delete Product</a>
    <a href="{% url 'product_list' %}" class="btn btn-primary">Back to Products</a>
</div>
{% endblock %}
